\Opensolutionfile{solution_file}[solutions/sols_070]
% в квадратных скобках фактическое имя файла

\chapter{Мультиколлинеарность}


\begin{problem}
Сгенерируйте данные так, чтобы при оценке модели $\hy=\hb_1+\hb_2x+\hb_3z$ оказывалось, что по отдельности оценки коэффициентов $\hb_2$ и $\hb_3$ незначимы, но модель в целом — значима.

\begin{sol}
\end{sol}
\end{problem}


\begin{problem}
В этом задании нужно сгенерировать зависимую переменную $y$ и два регрессора $x$ и $z$.
\begin{enumerate}
\item Сгенерируйте данные так, чтобы корреляция между регрессорами $x$ и $z$ была больше $0.9$, и проблема мультиколлинеарности есть, т.е. по отдельности регрессоры не значимы, но регрессия в целом — значима.
\item А теперь сгенерируйте данные так, чтобы корреляция между регрессорами была по-прежнему больше $0.9$, но проблемы мультиколлинеарности бы не было, то есть все коэффициенты были бы значимы.
\item Есть несколько способов, как изменить генерации случайных величин, чтобы перейти от ситуации «a» к ситуации «b». Назовите хотя бы два.
\end{enumerate}

\begin{sol}
увеличить количество наблюдений, уменьшить дисперсию случайной ошибки
\end{sol}
\end{problem}




\begin{problem}
Исследуем зависимость длины тормозного пути автомобиля от скорости по историческим данным 1920-х годов.

\begin{minted}[mathescape, numbersep=5pt, frame=lines, framesep=2mm]{r}
ggplot(data = cars, aes(x = speed, y = dist)) + geom_point() +
    labs(title = "Зависимость длины тормозного пути",
    x = "Скорость, миль в час", y = "Длина пути, футов")
\end{minted}


\begin{minipage}{0.6\textwidth}
\begin{center}
\input{R_plots/cars_scatter.tex}
\end{center}
\end{minipage}



Известны результаты оценивания нецентрированной регрессии:

\begin{minted}[mathescape, numbersep=5pt, frame=lines, framesep=2mm]{r}
cars_model <- lm(dist ~ speed + I(speed^2) + I(speed^3), data = cars)
cars_table <- as.table(coeftest(cars_model))
rownames(cars_table) <-
  c("Константа", "speed", "speed^2", "speed^3")
xtable(cars_table)
cars_vcov <- vcov(cars_model)
rownames(cars_vcov) <-
  c("Константа", "speed", "speed^2", "speed^3")
colnames(cars_vcov) <- rownames(cars_vcov)
xtable(cars_vcov)
\end{minted}

%\todo[inline]{с тремя переменными руками громоздко делать, а с двумя вроде не видно мультик.}


\begin{tabular}{rrrrr}
  \hline
 & Estimate & Std. Error & t value & Pr($>$$|$t$|$) \\ 
  \hline
Константа & -19.51 & 28.41 & -0.69 & 0.50 \\ 
  speed & 6.80 & 6.80 & 1.00 & 0.32 \\ 
  speed\verb|^|2 & -0.35 & 0.50 & -0.70 & 0.49 \\ 
  speed\verb|^|3 & 0.01 & 0.01 & 0.91 & 0.37 \\ 
   \hline
\end{tabular}


Ковариационная матрица коэффициентов имеет вид:

\begin{tabular}{rrrrr}
  \hline
 & Константа & speed & speed\verb|^|2 & speed\verb|^|3 \\ 
  \hline
Константа & 806.86 & -186.20 & 12.88 & -0.27 \\ 
  speed & -186.20 & 46.26 & -3.35 & 0.07 \\ 
  speed\verb|^|2 & 12.88 & -3.35 & 0.25 & -0.01 \\ 
  speed\verb|^|3 & -0.27 & 0.07 & -0.01 & 0.00 \\ 
   \hline
\end{tabular}


\begin{enumerate}
\item Проверьте значимость всех коэффициентов и регрессии в целом.
\item Постройте 95\%-ый доверительный интервал для $\E(dist)$ при $speed=10$.
\item Постройте 95\%-ый доверительный интервал для $\E(\partial dist/ \partial speed)$ при $speed=10$.
\item Как выглядит уравнение регрессии, если вместо $speed$ использовать центрированную скорость? Известно, что средняя скорость равна $15.4$. 
\item С помощью регрессии с центрированной скоростью ответьте на предыдущие вопросы.
\end{enumerate}
% here

\begin{sol}
\end{sol}
\end{problem}


\begin{problem}
Пионеры, Крокодил Гена и Чебурашка собирали металлолом несколько дней подряд. В распоряжение иностранной шпионки, гражданки Шапокляк, попали ежедневные данные по количеству собранного металлолома: вектор $g$ — для Крокодила Гены, вектор $h$ — для Чебурашки и вектор $x$ — для Пионеров. Гена и Чебурашка собирали вместе, поэтому выборочная корреляция $\sCorr(g,h)=-0.9$. Гена и Чебурашка собирали независимо от Пионеров, поэтому выборочные корреляции $\sCorr(g,x)=0$, $\sCorr(h,x)=0$. Если регрессоры $g$, $h$ и $x$ центрировать и нормировать, то получится матрица $\tilde{X}$.
\begin{enumerate}
\item Найдите параметр обусловленности матрицы $(\tilde{X}'\tilde{X})$.
\item Вычислите одну или две главные компоненты (выразите их через вектор-столбцы матрицы. $\tilde{X}$), объясняющие не менее 70\% общей выборочной дисперсии регрессоров.
\item Шпионка Шапокляк пытается смоделировать ежедневный выпуск танков, $y$. Выразите оценки коэффициентов регрессии $y = \beta_1 + \beta_2 g +\beta_3 h +\beta_4 x+\varepsilon$ через оценки коэффициентов регрессии на главные компоненты, объясняющие не менее 70\% общей выборочной дисперсии.
\end{enumerate}

\begin{sol}
\end{sol}
\end{problem}




\begin{problem}
Для модели $y_i=\beta x_i+\e$ рассмотрите модель гребневой регрессии с коэффициентом $\lambda$.
\begin{enumerate}
\item Выведите формулу для $\hb_{rr}$.
\item Найдите $\E(\hb_{rr})$, смещение оценки $\hb_{rr}$.
\item Найдите $\Var(\hb_{rr})$, $MSE(\hb_{rr})$.
\item Всегда ли оценка $\hb_{rr}$ смещена?
\item Всегда ли оценка $\hb_{rr}$ имеет меньшую дисперсию, чем $\hb_{ols}$?
\item Найдите такое $\lambda$, что $MSE(\hb_{rr})<MSE(\hb_{ols})$.
\end{enumerate}

\begin{sol}
\end{sol}
\end{problem}




\begin{problem}
Известно, что в модели $y=X\beta+\e$ все регрессоры ортогональны.
\begin{enumerate}
\item Как выглядит матрица $X'X$ в случае ортогональных регрессоров?
\item Выведите $\hb_{rr}$ в явном виде.
\item Как связаны между собой $\hb_{rr}$ и $\hb_{ols}$?
\end{enumerate}

\begin{sol}
\end{sol}
\end{problem}



\begin{problem}
Для модели $y_i=\beta x_i + \e_i$ выведите в явном виде $\hb_{lasso}$.

\begin{sol}
\end{sol}
\end{problem}



\begin{problem}
Предположим, что для модели $y_i= \beta_1 + \beta_2 x_{i2} + \beta_3 x_{i3} + \beta_4 x_{i4}  + \e_i$ выборочная корреляционная матрица регрессоров $x_2$, $x_3$, $x_4$ имеет вид

\[
C =
\begin{pmatrix}
1 & r & r  \\
r & 1 & r  \\
r & r & 1
\end{pmatrix}
\]


\begin{enumerate}
\item Найдите такое значение $r^* \in (-1;1)$ коэффициента корреляции, при котором $\det C = 0$.
\item Найдите собственные значения и собственные векторы матрицы $C$ при корреляции равной найденному $r^*$.
\item Найдите число обусловленности матрицы $C$ при корреляции равной найденному $r^*$.
\item Сделайте вывод о наличии мультиколлинеарности в модели при корреляции равной найденному $r^*$.
\end{enumerate}


\begin{sol}
$r^* = -1/2$
\end{sol}
\end{problem}





\begin{problem}
Предположим, что для модели $y_i= \beta_1 + \beta_2 x_{i2} + \beta_3 x_{i3} + \beta_4 x_{i4} + \beta_5 x_{i5} + \e_i$ выборочная корреляционная матрица регрессоров $x_2$, $x_3$, $x_4$ и $x_5$ имеет вид

\[
C =
\begin{pmatrix}
1 & r & r & r \\
r & 1 & r & r \\
r & r & 1 & r \\
r & r & r & 1
\end{pmatrix}
\]


\begin{enumerate}
\item Найдите такое значение $r^* \in (-1;1)$ коэффициента корреляции, при котором $\det C = 0$.
\item Найдите собственные значения и собственные векторы матрицы $C$ при корреляции равной найденному $r^*$.
\item Найдите число обусловленности матрицы $C$ при корреляции равной найденному $r^*$.
\item Сделайте вывод о наличии мультиколлинеарности в модели при корреляции равной найденному $r^*$.
\end{enumerate}


\begin{sol}
$r^* = -1/3$
\end{sol}
\end{problem}


\begin{problem}
Эконометресса Фатима оценивает модель $y_i=\beta_1 +\beta_2 x_i + \beta_3 z_i + \e_i$. Известно, что $\e_i \sim \cN(0,76)$. Про регрессоры известно, что $\sum (x_i-\bar{x})^2=10$, $\sum (z_i-\bar{z})^2=20$, а выборочная корреляция между ними равна $\sCorr(x,z)=0.9$.

Найдите $\Var(\hb_2)$, $\Var(\hb_3)$


\begin{sol}
$\Var(\hb_2)=\frac{\sigma^2}{RSS_2}=40$, $\Var(\hb_3)=\frac{\sigma^2}{RSS_3}=20$, а $RSS_j=(1-R^2_j) \cdot TSS_j$. При этом в парной регрессии $x$ на $z$ или $z$ на $x$ коэффициенты $R^2$ равны и равны квадрату выборочной корреляции, то есть $R^2_j=0.81$.
\end{sol}
\end{problem}


\begin{problem}
Эконометресса Алевтина перешла от исходных регрессоров к трём главным компонентам, $z_1$, $z_2$ и $z_3$. И далее посчитала коэффициенты вздутия дисперсии, $VIF_j$, для главных компонент. Чему они оказались равны?


\begin{sol}
$1$, т.к. все главные компоненты ортогональны
\end{sol}
\end{problem}



\begin{problem}
С помощью трёх-кратной кросс-валидации выберите наилучшее из двух $\lambda$, $1$ или $10$, в гребневой регрессии $y_i=\beta x_i + \e_i$:
\begin{tabular}{cc}
\toprule
$y_i$ & $x_i$ \\
\midrule
1 & 1 \\
5 & 1 \\
5 & 2 \\
\bottomrule
\end{tabular}


\begin{sol}

\end{sol}
\end{problem}



\begin{problem}
Известно, что выборочная корреляция между переменными $x$ и $z$ равна $0.9$.
\begin{enumerate}
\item Найдите коэффициенты $VIF$ для $x$ и $z$ в регрессии $y_i=\beta_1 + \beta_2 x_i + \beta_3 z_i + \e_i$.
\item В каких пределах могут лежать коэффициенты VIF для $x$ и $z$ в регрессии $y_i=\beta_1 + \beta_2 x_i + \beta_3 z_i + \beta_4 w_i + \e_i$?
\end{enumerate}


\begin{sol}
$VIF=1/0.19$, $VIF\geq 1/0.19$
\end{sol}
\end{problem}


\begin{problem}
Эконометресса Мишель построила регрессию, затем рассчитала прогноз и построила 90\%-ый предиктивный интервал. И после этого с ужасом обнаружила, что в данных есть мультиколлинеарность. Тогда Мишель с целью уменьшения дисперсии прогнозов решила перейти к ортогональным переменным. Вместо трёх исходных регрессоров Мишель использовала три главных компоненты в новой регрессии.

\begin{enumerate}
\item Как изменятся прогнозы?
\item Как изменится 90\%-ый предиктивный интервал?
\end{enumerate}


\begin{sol}
Никак, Мишель сделала линейную замену регрессоров, $\tilde X = X \cdot A$, где $A$ — обратима.
\end{sol}
\end{problem}


\begin{problem}
Известна матрица выборочных ковариаций трёх переменных. Для удобства будем считать, что переменные уже центрированы.

\[
\begin{pmatrix}
4 & 1 & -1 \\
1 & 5 & 0 \\
-1 & 0 & 9
\end{pmatrix}
\]

\begin{enumerate}
\item Выразите первую и вторую главные компоненты через три исходных переменных.
\item Выразите первую и вторую главные компоненты, через три исходных переменных, если перед методом главных компонент переменные необходимо стандартизировать.
\end{enumerate}
\begin{sol}
\end{sol}
\end{problem}

\begin{problem}
Василий строит регрессию количества съедаемого мороженого $y_i$ (в кг) на константу и дамми-переменную $d_i$, равную 1 для мужчин и 0 для женщин. Однако в выборке у Василия только мужчины, поэтому Василий использует гребневую регрессию и LASSO.

\begin{enumerate}
\item Какие оценки $\beta_1$ и $\beta_2$ Василий получит в зависимости от штрафного коэффициента $\lambda$, если Василий не штрафует $\beta_1$? Какие прогнозы получит Василий?
\item Как изменится результат, если Василий штрафует за $\beta_1$?
\item Как изменятся ответы на предыдущие вопросы, если в выборке у Василия только женщины?
\end{enumerate}


\begin{sol}
\end{sol}
\end{problem}



\Closesolutionfile{solution_file}
